<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Th∆∞ M·ªùi T·ªët Nghi·ªáp - B√°c Sƒ© N·ªôi Tr√∫ K47</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        overflow-x: hidden;
      }

      .container {
        max-width: 800px;
        margin: 0 auto;
        padding: 40px 20px;
      }

      .invitation-card {
        background: white;
        border-radius: 20px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        padding: 50px;
        position: relative;
        overflow: hidden;
      }

      .header {
        text-align: center;
        margin-bottom: 40px;
      }

      .header h1 {
        color: #667eea;
        font-size: 32px;
        margin-bottom: 10px;
      }

      .header .subtitle {
        color: #666;
        font-size: 18px;
        font-weight: 600;
      }

      .divider {
        height: 2px;
        background: linear-gradient(90deg, transparent, #667eea, transparent);
        margin: 30px 0;
      }

      .content {
        color: #333;
        line-height: 1.8;
        font-size: 16px;
      }

      .content p {
        margin-bottom: 15px;
      }

      .event-details {
        background: #f8f9fa;
        padding: 20px;
        border-radius: 12px;
        margin: 30px 0;
      }

      .event-details h3 {
        color: #667eea;
        margin-bottom: 15px;
      }

      .event-details p {
        margin-bottom: 8px;
      }

      .event-details strong {
        color: #333;
      }

      .gallery {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 15px;
        margin: 30px 0;
      }

      .gallery-item {
        aspect-ratio: 4/3;
        border-radius: 12px;
        overflow: hidden;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        transition: transform 0.3s;
      }

      .gallery-item:hover {
        transform: scale(1.05);
      }

      .gallery-item img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }

      .rsvp-section {
        margin-top: 40px;
        padding: 30px;
        background: #f8f9fa;
        border-radius: 12px;
        text-align: center;
        display: none;
      }

      .rsvp-section.show {
        display: block;
      }

      .rsvp-question {
        font-size: 24px;
        font-weight: 600;
        color: #333;
        margin-bottom: 30px;
      }

      .guest-name {
        color: #667eea;
      }

      .rsvp-buttons {
        display: flex;
        gap: 20px;
        justify-content: center;
        flex-wrap: wrap;
      }

      .rsvp-btn {
        padding: 15px 40px;
        font-size: 18px;
        font-weight: 600;
        border: none;
        border-radius: 12px;
        cursor: pointer;
        transition: all 0.3s;
        min-width: 200px;
      }

      .btn-yes {
        background: #28a745;
        color: white;
      }

      .btn-yes:hover {
        background: #218838;
        transform: translateY(-2px);
      }

      .btn-no {
        background: #dc3545;
        color: white;
      }

      .btn-no:hover {
        background: #c82333;
        transform: translateY(-2px);
      }

      .rsvp-btn:disabled {
        opacity: 0.6;
        cursor: not-allowed;
        transform: none !important;
      }

      .thank-you {
        display: none;
        text-align: center;
        padding: 30px;
        background: white;
        border-radius: 12px;
        margin-top: 20px;
      }

      .thank-you.show {
        display: block;
      }

      .thank-you h3 {
        color: #28a745;
        font-size: 24px;
        margin-bottom: 15px;
      }

      .thank-you p {
        color: #666;
        font-size: 16px;
      }

      /* Fireworks animation */
      .firework {
        position: fixed;
        width: 4px;
        height: 4px;
        border-radius: 50%;
        pointer-events: none;
        z-index: 1000;
      }

      @keyframes explode {
        0% {
          opacity: 1;
          transform: translate(0, 0) scale(1);
        }
        100% {
          opacity: 0;
          transform: translate(var(--tx), var(--ty)) scale(0);
        }
      }

      .scroll-indicator {
        text-align: center;
        margin-top: 30px;
        color: #667eea;
        font-weight: 600;
        animation: bounce 2s infinite;
      }

      @keyframes bounce {
        0%,
        20%,
        50%,
        80%,
        100% {
          transform: translateY(0);
        }
        40% {
          transform: translateY(-10px);
        }
        60% {
          transform: translateY(-5px);
        }
      }

      @media (max-width: 600px) {
        .invitation-card {
          padding: 30px 20px;
        }

        .header h1 {
          font-size: 24px;
        }

        .rsvp-question {
          font-size: 20px;
        }

        .rsvp-btn {
          min-width: 150px;
          padding: 12px 30px;
          font-size: 16px;
        }
      }
    </style>
  </head>
  <body>
    <div
      style="
        width: 100vw;
        position: fixed;
        display: flex;
        justify-content: center;
        bottom: 0;
        z-index: 10;
      "
    >
      <audio controls loop style="">
        <source src="./backgound_music.mp3" type="audio/mpeg" />
        Your browser does not support the audio element.
      </audio>
    </div>
    <div class="container">
      <div class="invitation-card">
        <div class="header">
          <h1>üéì TH∆Ø M·ªúI LI√äN HOAN T·ªêT NGHI·ªÜP</h1>
          <p class="subtitle">B√°c sƒ© n·ªôi tr√∫ Th·∫ßn kinh - kh√≥a 47</p>
          <p class="subtitle">Tr∆∞·ªùng ƒê·∫°i H·ªçc Y H√† N·ªôi</p>
        </div>

        <div class="divider"></div>

        <div class="content">
          <p>
            K√≠nh g·ª≠i: <strong class="guestTitle"></strong>
            <strong class="guestName"></strong>
          </p>

          <p>
            V·ªõi ni·ªÅm vui v√† t·ª± h√†o, ch√∫ng em - B√°c sƒ© n·ªôi tr√∫ Th·∫ßn kinh - Kh√≥a
            47 Tr∆∞·ªùng ƒê·∫°i h·ªçc Y H√† N·ªôi xin tr√¢n tr·ªçng k√≠nh m·ªùi
            <span class="guestTitle"></span> ƒë·∫øn d·ª± b·ªØa ti·ªác th√¢n m·∫≠t ch√∫c m·ª´ng
            t·ªët nghi·ªáp c·ªßa ch√∫ng em.
          </p>

          <p>
            Sau nh·ªØng nƒÉm th√°ng h·ªçc t·∫≠p v√† r√®n luy·ªán kh√¥ng ng·ª´ng ngh·ªâ, ch√∫ng em
            ƒë√£ ho√†n th√†nh ch∆∞∆°ng tr√¨nh ƒë√†o t·∫°o B√°c sƒ© N·ªôi tr√∫. ƒê√¢y l√† d·∫•u m·ªëc
            quan tr·ªçng, ƒë√°nh d·∫•u b∆∞·ªõc chuy·ªÉn m√¨nh trong s·ª± nghi·ªáp y khoa c·ªßa
            ch√∫ng em.
          </p>

          <div class="event-details">
            <h3>üìÖ TH√îNG TIN S·ª∞ KI·ªÜN</h3>
            <p><strong>Th·ªùi gian:</strong> 18:00, Th·ª© NƒÉm, ng√†y 27/11/2025</p>
            <p>
              <strong>ƒê·ªãa ƒëi·ªÉm:</strong> T·∫ßng 2, B√≤ T∆° Qu√°n M·ªôc Hoa L∆∞, 02 P.
              Hoa L∆∞, L√™ ƒê·∫°i H√†nh, Hai B√† Tr∆∞ng, H√† N·ªôi.
            </p>
            <p><strong>Dress code:</strong> Trang tr·ªçng</p>
          </div>

          <iframe
            src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3724.562577210095!2d105.84514167531154!3d21.010164380634535!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3135ab4e1ba19b37%3A0x1efd1e5c66f3c162!2zQsOyIFTGoSBRdcOhbiBN4buZYyBIb2EgTMaw!5e0!3m2!1sen!2s!4v1764001248110!5m2!1sen!2s"
            width="600"
            height="450"
            style="border: 0"
            allowfullscreen=""
            loading="lazy"
            referrerpolicy="no-referrer-when-downgrade"
          ></iframe>

          <p>Ch∆∞∆°ng tr√¨nh g·ªìm:</p>
          <ul style="margin-left: 30px; margin-bottom: 15px">
            <li>Ti·ªác th√¢n m·∫≠t t·∫°i nh√† h√†ng</li>
            <li>Ch∆∞∆°ng tr√¨nh giao l∆∞u ca nh·∫°c</li>
          </ul>

          <h3 style="color: #667eea; margin-bottom: 15px; text-align: center">
            Kho·∫£nh kh·∫Øc ƒë√°ng nh·ªõ - Kh√≥a 47
          </h3>
          <div class="gallery">
            <div class="gallery-item">
              <img
                src="photo1.jpg"
                alt="C√°c b√°c sƒ© n·ªôi tr√∫ K47 - Ninh B√¨nh"
                loading="lazy"
              />
            </div>
            <div class="gallery-item">
              <img
                src="photo2.jpg"
                alt="L·ªõp h·ªçc B√°c sƒ© N·ªôi tr√∫"
                loading="lazy"
              />
            </div>
            <div class="gallery-item">
              <img src="photo8.jpg" alt="Du l·ªãch H·∫° Long" loading="lazy" />
            </div>
            <div class="gallery-item">
              <img src="photo9.jpg" alt="Du l·ªãch H·∫° Long" loading="lazy" />
            </div>
            <div class="gallery-item">
              <img src="photo10.jpg" alt="Du l·ªãch H·∫° Long" loading="lazy" />
            </div>
            <div class="gallery-item">
              <img src="photo11.jpg" alt="Du l·ªãch H·∫° Long" loading="lazy" />
            </div>
            <div class="gallery-item">
              <img src="photo5.jpg" alt="Teamwork" loading="lazy" />
            </div>
            <div class="gallery-item">
              <img src="photo6.jpg" alt="Du l·ªãch H·∫° Long" loading="lazy" />
            </div>
          </div>

          <p>
            S·ª± hi·ªán di·ªán c·ªßa <span class="guestTitle"></span> s·∫Ω l√† ni·ªÅm vinh d·ª±
            v√† ƒë·ªông l·ª±c to l·ªõn cho ch√∫ng em trong h√†nh tr√¨nh ph√≠a tr∆∞·ªõc.
          </p>

          <p style="text-align: right; margin-top: 30px; font-style: italic">
            Tr√¢n tr·ªçng k√≠nh m·ªùi!<br />
            <strong>Ban T·ªï Ch·ª©c</strong><br />
            B√°c sƒ© n·ªôi tr√∫ Th·∫ßn kinh - Kh√≥a 47<br />
            Tr∆∞·ªùng ƒêH Y H√† N·ªôi
          </p>
        </div>

        <div class="scroll-indicator">
          ‚Üì Vui l√≤ng cu·ªôn xu·ªëng ƒë·ªÉ x√°c nh·∫≠n tham d·ª± ‚Üì
        </div>

        <div class="rsvp-section" id="rsvpSection">
          <p class="rsvp-question">
            <span class="guest-name" id="rsvpGuestName"></span> ch·∫Øc ch·∫Øn tham
            d·ª± ƒë∆∞·ª£c ch·ª©?
          </p>
          <div class="rsvp-buttons">
            <button
              class="rsvp-btn btn-yes"
              onclick="submitRSVP('Ch·∫Øc ch·∫Øn r·ªìi')"
            >
              ‚úì Ch·∫Øc ch·∫Øn r·ªìi
            </button>
            <button
              class="rsvp-btn btn-no"
              onclick="submitRSVP('T√¥i b·∫≠n m·∫•t r·ªìi')"
            >
              ‚úó T√¥i b·∫≠n m·∫•t r·ªìi
            </button>
          </div>
        </div>

        <div class="thank-you" id="thankYou">
          <h3>C·∫£m ∆°n b·∫°n!</h3>
          <p id="thankYouMessage"></p>
        </div>
      </div>
    </div>

    <script>
      // Thay ƒë·ªïi URL n√†y th√†nh URL c·ªßa Google Apps Script Web App
      const GOOGLE_SCRIPT_URL =
        "https://script.google.com/macros/s/AKfycbzm5Ph5yCCWjuCEzsT9JbmuVHA01qh-8aJXke0kDxC5r0gz3FsmAnWLgdtVrHM_4O7w5w/exec";

      let guestData = null;

      // Parse invite data from URL
      function parseInviteData() {
        const urlParams = new URLSearchParams(window.location.search);
        const title = urlParams.get("title");
        const name = urlParams.get("name");

        // Check if we have the new format with direct params
        if (title && name) {
          return {
            title: decodeURIComponent(title),
            name: decodeURIComponent(name),
          };
        }

        return null;
      }

      // Initialize page
      window.addEventListener("DOMContentLoaded", function () {
        guestData = parseInviteData();

        if (guestData) {
          document.querySelectorAll(".guestTitle").forEach((element) => {
            element.textContent = guestData.title;
          });
          document.querySelectorAll(".guestName").forEach((element) => {
            element.textContent = guestData.name;
          });
          document.getElementById("rsvpGuestName").textContent =
            guestData.title + " " + guestData.name;
        } else {
          document.querySelectorAll(".guestTitle").forEach((element) => {
            element.textContent = guestData.title;
          });
          document.querySelectorAll(".guestName").forEach((element) => {
            element.textContent = guestData.name;
          });
          document.getElementById("rsvpGuestName").textContent = "B·∫°n";
        }

        // Start fireworks
        createFireworks();

        // Show RSVP section when scrolling near bottom
        window.addEventListener("scroll", function () {
          const scrollPosition = window.innerHeight + window.scrollY;
          const documentHeight = document.documentElement.scrollHeight;

          if (scrollPosition >= documentHeight - 300) {
            document.getElementById("rsvpSection").classList.add("show");
          }
        });
      });

      // Create fireworks effect
      function createFireworks() {
        setInterval(() => {
          const colors = [
            "#ff0000",
            "#00ff00",
            "#0000ff",
            "#ffff00",
            "#ff00ff",
            "#00ffff",
          ];
          const x = Math.random() * window.innerWidth;
          const y = Math.random() * (window.innerHeight / 2);

          for (let i = 0; i < 30; i++) {
            createParticle(
              x,
              y,
              colors[Math.floor(Math.random() * colors.length)]
            );
          }
        }, 2000);
      }

      function createParticle(x, y, color) {
        const particle = document.createElement("div");
        particle.className = "firework";
        particle.style.left = x + "px";
        particle.style.top = y + "px";
        particle.style.background = color;

        const angle = Math.random() * Math.PI * 2;
        const velocity = 50 + Math.random() * 100;
        const tx = Math.cos(angle) * velocity;
        const ty = Math.sin(angle) * velocity;

        particle.style.setProperty("--tx", tx + "px");
        particle.style.setProperty("--ty", ty + "px");
        particle.style.animation = "explode 1s ease-out forwards";

        document.body.appendChild(particle);

        setTimeout(() => {
          particle.remove();
        }, 1000);
      }

      // Submit RSVP
      async function submitRSVP(response) {
        const buttons = document.querySelectorAll(".rsvp-btn");
        buttons.forEach((btn) => (btn.disabled = true));

        const data = {
          title: guestData ? guestData.title : "Kh√°ch",
          name: guestData ? guestData.name : "Ch∆∞a x√°c ƒë·ªãnh",
          response: response,
          timestamp: new Date().toISOString(),
        };

        try {
          // Send to Google Apps Script
          const googleResponse = await fetch(GOOGLE_SCRIPT_URL, {
            method: "POST",
            mode: "no-cors",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify(data),
          });

          // Show thank you message
          document.getElementById("rsvpSection").style.display = "none";
          const thankYouDiv = document.getElementById("thankYou");
          const thankYouMessage = document.getElementById("thankYouMessage");

          if (response === "Ch·∫Øc ch·∫Øn r·ªìi") {
            thankYouMessage.textContent =
              "Ch√∫ng em r·∫•t vui m·ª´ng v√† mong ch·ªù ƒë∆∞·ª£c g·∫∑p b·∫°n t·∫°i s·ª± ki·ªán!";
          } else {
            thankYouMessage.textContent =
              "Ch√∫ng t√¥i r·∫•t ti·∫øc v√¨ b·∫°n kh√¥ng th·ªÉ tham d·ª±. H·∫πn g·∫∑p l·∫°i b·∫°n v√†o d·ªãp kh√°c!";
          }

          thankYouDiv.classList.add("show");

          // Create celebration fireworks
          for (let i = 0; i < 5; i++) {
            setTimeout(() => {
              const x = Math.random() * window.innerWidth;
              const y = Math.random() * window.innerHeight;
              const colors = [
                "#ff0000",
                "#00ff00",
                "#0000ff",
                "#ffff00",
                "#ff00ff",
              ];
              for (let j = 0; j < 50; j++) {
                createParticle(
                  x,
                  y,
                  colors[Math.floor(Math.random() * colors.length)]
                );
              }
            }, i * 200);
          }
        } catch (error) {
          console.error("Error submitting RSVP:", error);
          alert("ƒê√£ x·∫£y ra l·ªói khi g·ª≠i ph·∫£n h·ªìi. Vui l√≤ng th·ª≠ l·∫°i sau.");
          buttons.forEach((btn) => (btn.disabled = false));
        }
      }
    </script>
  </body>
</html>
